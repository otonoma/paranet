<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-paraflow/runtime_internals" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Runtime Internals | Paranet Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.paranet.ai/img/paranet_logo.svg"><meta data-rh="true" name="twitter:image" content="https://docs.paranet.ai/img/paranet_logo.svg"><meta data-rh="true" property="og:url" content="https://docs.paranet.ai/paraflow/runtime_internals"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Runtime Internals | Paranet Documentation"><meta data-rh="true" name="description" content="Planner"><meta data-rh="true" property="og:description" content="Planner"><link data-rh="true" rel="icon" href="/img/paranet_favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.paranet.ai/paraflow/runtime_internals"><link data-rh="true" rel="alternate" href="https://docs.paranet.ai/paraflow/runtime_internals" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.paranet.ai/paraflow/runtime_internals" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.b116edeb.css">
<script src="/assets/js/runtime~main.9f100a16.js" defer="defer"></script>
<script src="/assets/js/main.a8b5a01a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/paranet_logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/paranet_logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Docs</b></a><a class="navbar__item navbar__link" href="/getting_started">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/paraflow">Paraflow</a><a class="navbar__item navbar__link" href="/developer_tools">Developer Tools</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/getting_started">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/paraflow">Paraflow</a><button aria-label="Collapse sidebar category &#x27;Paraflow&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paraflow/hello-world">Hello World</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paraflow/language-basics">Language Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paraflow/top-level">Top Level</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paraflow/variables">Variables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paraflow/control_flow">Control Flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paraflow/tables">Tables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paraflow/bindings">Bindings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/paraflow/runtime_internals">Runtime Internals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/paraflow/debugging">Debugger</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/developer_tools">Developer Tools</a><button aria-label="Expand sidebar category &#x27;Developer Tools&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/paraflow"><span itemprop="name">Paraflow</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Runtime Internals</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Runtime Internals</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="planner">Planner<a href="#planner" class="hash-link" aria-label="Direct link to Planner" title="Direct link to Planner">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="intent-states">Intent States<a href="#intent-states" class="hash-link" aria-label="Direct link to Intent States" title="Direct link to Intent States">​</a></h3>
<p><img decoding="async" loading="lazy" alt="internal state" src="/assets/images/internal_state-c2e89dddc548fa3403952bf7407ac174.png" width="750" height="472" class="img_ev3q"></p>
<ul>
<li><strong>pending</strong>: The planner has determined to execute this intent, but it may have sequence dependencies on other intents that are not yet complete.</li>
<li><strong>ready</strong>: All sequence dependencies are satisfied, and the intent is ready to execute when resources are available.</li>
<li><strong>active</strong>: Currently executing, which means:<!-- -->
<ul>
<li>For rules: waiting for sub-intents.</li>
<li>For tasks: executing the task body.</li>
</ul>
</li>
<li><strong>complete</strong>: Successfully completed.</li>
<li><strong>failed</strong>: Abandoned due to failure of the task or 1+ sub-intents in the case of rules.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="execution">Execution<a href="#execution" class="hash-link" aria-label="Direct link to Execution" title="Direct link to Execution">​</a></h2>
<p>Certain goals are designated as top-level goals. An instance of an agent corresponds to exactly one top-level goal instance. Each agent (i.e., top-level goal) instance is independent of any other instance and is planned and executed in a single logical container. The entire instance state is persistent, and the actual execution will be performed by one or more running processes on one or more machines over time, but never more than one process or machine at the same time.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="planningexecution-algorithm">Planning/Execution Algorithm<a href="#planningexecution-algorithm" class="hash-link" aria-label="Direct link to Planning/Execution Algorithm" title="Direct link to Planning/Execution Algorithm">​</a></h2>
<p>Rules support concurrent sub-tasks, so this is similar to HTN (Hierarchical Task Network) algorithms for partially-ordered tasks.</p>
<ol>
<li>An outside event triggers the creation of a new top-level goal.</li>
<li>Depth-first planning is performed.</li>
<li>Initialize planning state with the current state of static relations.</li>
<li>Non-deterministically select an unplanned goal.</li>
<li>If the goal is primitive, then:<!-- -->
<ul>
<li>Determine eligible and potential tasks.</li>
<li>If no eligible tasks:<!-- -->
<ul>
<li>If at least one potential task exists, return to step 5, otherwise fail.</li>
</ul>
</li>
<li>Calculate costs associated with eligible tasks.</li>
<li>Non-deterministically select one eligible task with minimal cost.</li>
<li>Apply static behavior to the planning state.</li>
<li>Add the selected task to the plan.</li>
<li>Transfer goal sequence constraints to the selected task.</li>
</ul>
</li>
<li>If the goal is not primitive, then:<!-- -->
<ul>
<li>Determine eligible and potential rules.</li>
<li>If no eligible rules:<!-- -->
<ul>
<li>If at least one potential rule exists, return to step 5, otherwise fail.</li>
</ul>
</li>
<li>Calculate costs associated with eligible rules.</li>
<li>Non-deterministically select one eligible rule with minimal cost.</li>
<li>Execute the rule with the planning state and collect resulting sub-goals with their sequence constraints.</li>
<li>Recursively plan sub-goals.</li>
<li>If sub-goals fail to plan, remove them from eligible rules and return to step 6.</li>
<li>Add sub-goals and their sequence constraints to the plan.</li>
<li>Transfer goal sequence constraints to each of the added sub-goals that are initial within the added sub-goals.</li>
</ul>
</li>
<li>While there remain unplanned goals, return to step 4.</li>
<li>Create an intent in the pending state for each task in the plan.</li>
<li>Execute intents.</li>
<li>While there remain unfulfilled goals, return to step 5.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="definitions">Definitions<a href="#definitions" class="hash-link" aria-label="Direct link to Definitions" title="Direct link to Definitions">​</a></h2>
<ul>
<li>
<p><strong>Eligible rule (or task)</strong>: A rule (or task) is eligible with respect to a goal for planning if:</p>
<ol>
<li>It does not have a precondition that depends on a dynamic relation, or all the target goal’s support goals have been achieved.</li>
<li>Any preconditions are true.</li>
</ol>
</li>
<li>
<p><strong>Potential rule (or task)</strong>: A rule (or task) is potential with respect to a goal for planning if its precondition depends on a dynamic relation and at least one of the target goal’s support goals is not complete.</p>
</li>
<li>
<p><strong>Support goal</strong>: Goal A is a support for goal B if there is a sequence constraint that A precedes B.</p>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/your-org/your-project/edit/main/paranet/paraflow/runtime_internals.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/paraflow/bindings"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Bindings</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/paraflow/debugging"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Debugger</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#planner" class="table-of-contents__link toc-highlight">Planner</a><ul><li><a href="#intent-states" class="table-of-contents__link toc-highlight">Intent States</a></li></ul></li><li><a href="#execution" class="table-of-contents__link toc-highlight">Execution</a></li><li><a href="#planningexecution-algorithm" class="table-of-contents__link toc-highlight">Planning/Execution Algorithm</a></li><li><a href="#definitions" class="table-of-contents__link toc-highlight">Definitions</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>